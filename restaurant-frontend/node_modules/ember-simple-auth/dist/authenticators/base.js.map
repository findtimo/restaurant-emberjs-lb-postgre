{"version":3,"file":"base.js","sources":["../../src/authenticators/base.js"],"sourcesContent":["import RSVP from 'rsvp';\nimport Evented from '@ember/object/evented';\nimport EmberObject from '@ember/object';\n\n/**\n  The base class for all authenticators. __This serves as a starting point for\n  implementing custom authenticators and must not be used directly.__\n\n  The authenticator authenticates the session. The actual mechanism used to do\n  this might, e.g., post a set of credentials to a server and in exchange\n  retrieve an access token, initiating authentication against an external\n  provider like Facebook, etc. The details depend on the specific authenticator.\n  Upon successful authentication, any data that the authenticator receives and\n  resolves via the promise returned from the\n  {{#crossLink \"BaseAuthenticator/authenticate:method\"}}{{/crossLink}}\n  method is stored in the session and can be accessed via the session service\n  to be used by the authorizer (see\n  {{#crossLink \"BaseAuthorizer/authorize:method\"}}{{/crossLink}}) to e.g.,\n  authorize outgoing requests.\n\n  The authenticator also decides whether a set of data that was restored from\n  the session store (see\n  {{#crossLink \"BaseStore/restore:method\"}}{{/crossLink}}) makes up an\n  authenticated session or not.\n\n  __Authenticators for an application are defined in the `app/authenticators`\n  directory__, e.g.:\n\n  ```js\n  // app/authenticators/oauth2.js\n  import OAuth2PasswordGrantAuthenticator from 'ember-simple-auth/authenticators/oauth2-password-grant';\n\n  export default class OAuth2Authenticator extends OAuth2PasswordGrantAuthenticator {\n    ...\n  }\n  ```\n\n  and can then be used via the name Ember CLI automatically registers for them\n  within the Ember container.\n\n  ```js\n  // app/components/login-form.js\n  import Component from '@ember/component';\n  import { inject as service } from '@ember/service';\n  import { action } from '@ember/object';\n\n  export default class LoginFormComponent extends Component {\n    @service session;\n\n    @action\n    authenticate() {\n      this.session.authenticate('authenticator:oauth2');\n    }\n  }\n  ```\n\n  @class BaseAuthenticator\n  @module ember-simple-auth/authenticators/base\n  @extends Ember.Object\n  @uses Ember.Evented\n  @public\n*/\nexport default EmberObject.extend(Evented, {\n  /**\n    __Triggered when the authentication data is updated by the authenticator\n    due to an external or scheduled event__. This might happen, e.g., if the\n    authenticator refreshes an expired token or an event is triggered from an\n    external authentication provider that the authenticator uses. The session\n    handles that event, passes the updated data back to the authenticator's\n    {{#crossLink \"BaseAuthenticator/restore:method\"}}{{/crossLink}}\n    method and handles the result of that invocation accordingly.\n\n    @event sessionDataUpdated\n    @param {Object} data The updated session data\n    @public\n  */\n\n  /**\n    __Triggered when the authentication data is invalidated by the authenticator\n    due to an external or scheduled event__. This might happen, e.g., if a token\n    expires or an event is triggered from an external authentication provider\n    that the authenticator uses. The session handles the event and will\n    invalidate itself when it is triggered.\n\n    @event sessionDataInvalidated\n    @public\n  */\n\n  /**\n    Restores the session from a session data object. __This method is invoked\n    by the session either on application startup if session data is restored\n    from the session store__ or when properties in the store change due to\n    external events (e.g. in another tab) and the new session data needs to be\n    validated for whether it constitutes an authenticated session.\n\n    __This method returns a promise. A resolving promise results in the session\n    becoming or remaining authenticated.__ Any data the promise resolves with\n    will be saved in and accessible via the session service's\n    `data.authenticated` property (see\n    {{#crossLink \"SessionService/data:property\"}}{{/crossLink}}). A rejecting\n    promise indicates that `data` does not constitute a valid session and will\n    result in the session being invalidated or remaining unauthenticated.\n\n    The `BaseAuthenticator`'s implementation always returns a rejecting\n    promise. __This method must be overridden in subclasses.__\n\n    @method restore\n    @param {Object} data The data to restore the session from\n    @return {Ember.RSVP.Promise} A promise that when it resolves results in the session becoming or remaining authenticated\n    @public\n  */\n  restore() {\n    return RSVP.reject();\n  },\n\n  /**\n    Authenticates the session with the specified `args`. These options vary\n    depending on the actual authentication mechanism the authenticator\n    implements (e.g. a set of credentials or a Facebook account id etc.). __The\n    session will invoke this method in order to authenticate itself__ (see\n    {{#crossLink \"SessionService/authenticate:method\"}}{{/crossLink}}).\n\n    __This method returns a promise. A resolving promise will result in the\n    session becoming authenticated.__ Any data the promise resolves with will\n    be saved in and accessible via the session service's `data.authenticated`\n    property (see {{#crossLink \"SessionService/data:property\"}}{{/crossLink}}).\n    A rejecting promise indicates that authentication failed and will result in\n    the session remaining unauthenticated.\n\n    The `BaseAuthenticator`'s implementation always returns a rejecting promise\n    and thus never authenticates the session. __This method must be overridden\n    in subclasses__.\n\n    @method authenticate\n    @param {Any} [...args] The arguments that the authenticator requires to authenticate the session\n    @return {Ember.RSVP.Promise} A promise that when it resolves results in the session becoming authenticated\n    @public\n  */\n  authenticate() {\n    return RSVP.reject();\n  },\n\n  /**\n    This method is invoked as a callback when the session is invalidated. While\n    the session will invalidate itself and clear all authenticated session data,\n    it might be necessary for some authenticators to perform additional tasks\n    (e.g. invalidating an access token on the server side).\n\n    __This method returns a promise. A resolving promise will result in the\n    session becoming unauthenticated.__ A rejecting promise will result in\n    invalidation being intercepted and the session remaining authenticated.\n\n    The `BaseAuthenticator`'s implementation always returns a resolving promise\n    and thus never intercepts session invalidation. __This method doesn't have\n    to be overridden in custom authenticators__ if no actions need to be\n    performed on session invalidation.\n\n    @method invalidate\n    @param {Object} data The current authenticated session data\n    @param {Array} ...args additional arguments as required by the authenticator\n    @return {Ember.RSVP.Promise} A promise that when it resolves results in the session being invalidated\n    @public\n  */\n  invalidate() {\n    return RSVP.resolve();\n  }\n});\n"],"names":["EmberObject","extend","Evented","restore","RSVP","reject","authenticate","invalidate","resolve"],"mappings":";;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAeA,WAAW,CAACC,MAAM,CAACC,OAAO,EAAE;AACzC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIEC,EAAAA,OAAOA,GAAG;AACR,IAAA,OAAOC,IAAI,CAACC,MAAM,EAAE,CAAA;GACrB;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIEC,EAAAA,YAAYA,GAAG;AACb,IAAA,OAAOF,IAAI,CAACC,MAAM,EAAE,CAAA;GACrB;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIEE,EAAAA,UAAUA,GAAG;AACX,IAAA,OAAOH,IAAI,CAACI,OAAO,EAAE,CAAA;AACvB,GAAA;AACF,CAAC,CAAC;;;;"}