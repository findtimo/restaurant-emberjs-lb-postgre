{"version":3,"file":"element.js","sources":["../../src/helpers/element.ts"],"sourcesContent":["// eslint-disable-next-line ember/no-classic-components\nimport EmberComponent from '@ember/component';\nimport Helper from '@ember/component/helper';\nimport { assert, runInDebug } from '@ember/debug';\nimport { ensureSafeComponent } from '@embroider/util';\n\nimport type { ComponentLike } from '@glint/template';\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nfunction UNINITIALIZED() {}\n\nexport type ElementFromTagName<T extends string> = T extends keyof HTMLElementTagNameMap\n  ? HTMLElementTagNameMap[T]\n  : Element;\n\ntype Positional<T extends string> = [name: T];\ntype Return<T extends string> = ComponentLike<{\n  Element: ElementFromTagName<T>;\n  Blocks: { default: [] };\n}>;\n\nexport interface ElementSignature<T extends string> {\n  Args: {\n    Positional: Positional<T>;\n  };\n  Return: Return<T> | undefined;\n}\n\nexport default class ElementHelper<T extends string> extends Helper<ElementSignature<T>> {\n  tagName: string | (() => void) = UNINITIALIZED;\n  componentClass?: Return<T>;\n\n  compute(params: Positional<T>, hash: object) {\n    assert('The `element` helper takes a single positional argument', params.length === 1);\n    assert(\n      'The `element` helper does not take any named arguments',\n      Object.keys(hash).length === 0\n    );\n\n    let tagName = params[0];\n\n    if (tagName !== this.tagName) {\n      this.tagName = tagName;\n\n      if (typeof tagName === 'string') {\n        this.componentClass = ensureSafeComponent(\n          // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n          // @ts-ignore\n          class DynamicElement extends EmberComponent {\n            tagName = tagName; // eslint-disable-line ember/require-tagless-components\n          },\n          this\n        ) as unknown as Return<T>;\n      } else {\n        this.componentClass = undefined;\n\n        runInDebug(() => {\n          let message = 'The argument passed to the `element` helper must be a string';\n\n          try {\n            message += ` (you passed \\`${tagName}\\`)`;\n          } catch (e) {\n            // ignore\n          }\n\n          assert(message, tagName === undefined || tagName === null);\n        });\n      }\n    }\n\n    return this.componentClass;\n  }\n}\n"],"names":["UNINITIALIZED","ElementHelper","Helper","constructor","args","_defineProperty","compute","params","hash","assert","length","Object","keys","tagName","componentClass","ensureSafeComponent","DynamicElement","EmberComponent","undefined","runInDebug","message","e"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA;AACA,SAASA,aAAaA,GAAG,EAAC;AAmBX,MAAMC,aAAa,SAA2BC,MAAM,CAAsB;AAAAC,EAAAA,WAAAA,CAAA,GAAAC,IAAA,EAAA;AAAA,IAAA,KAAA,CAAA,GAAAA,IAAA,CAAA,CAAA;AAAAC,IAAAA,eAAA,kBACtDL,aAAa,CAAA,CAAA;IAAAK,eAAA,CAAA,IAAA,EAAA,gBAAA,EAAA,KAAA,CAAA,CAAA,CAAA;AAAA,GAAA;AAG9CC,EAAAA,OAAOA,CAACC,MAAqB,EAAEC,IAAY,EAAE;IAC3CC,MAAM,CAAC,yDAAyD,EAAEF,MAAM,CAACG,MAAM,KAAK,CAAC,CAAC,CAAA;AACtFD,IAAAA,MAAM,CACJ,wDAAwD,EACxDE,MAAM,CAACC,IAAI,CAACJ,IAAI,CAAC,CAACE,MAAM,KAAK,CAC/B,CAAC,CAAA;AAED,IAAA,IAAIG,OAAO,GAAGN,MAAM,CAAC,CAAC,CAAC,CAAA;AAEvB,IAAA,IAAIM,OAAO,KAAK,IAAI,CAACA,OAAO,EAAE;MAC5B,IAAI,CAACA,OAAO,GAAGA,OAAO,CAAA;AAEtB,MAAA,IAAI,OAAOA,OAAO,KAAK,QAAQ,EAAE;QAC/B,IAAI,CAACC,cAAc,GAAGC,mBAAmB;AACvC;AACA;QACA,MAAMC,cAAc,SAASC,cAAc,CAAC;AAAAd,UAAAA,WAAAA,CAAA,GAAAC,IAAA,EAAA;AAAA,YAAA,KAAA,CAAA,GAAAA,IAAA,CAAA,CAAA;AAAAC,YAAAA,eAAA,kBAChCQ,OAAO,CAAA,CAAA;WAAE;SACpB,EACD,IACF,CAAyB,CAAA;AAC3B,OAAC,MAAM;QACL,IAAI,CAACC,cAAc,GAAGI,SAAS,CAAA;AAE/BC,QAAAA,UAAU,CAAC,MAAM;UACf,IAAIC,OAAO,GAAG,8DAA8D,CAAA;UAE5E,IAAI;YACFA,OAAO,IAAK,CAAiBP,eAAAA,EAAAA,OAAQ,CAAI,GAAA,CAAA,CAAA;WAC1C,CAAC,OAAOQ,CAAC,EAAE;AACV;AAAA,WAAA;UAGFZ,MAAM,CAACW,OAAO,EAAEP,OAAO,KAAKK,SAAS,IAAIL,OAAO,KAAK,IAAI,CAAC,CAAA;AAC5D,SAAC,CAAC,CAAA;AACJ,OAAA;AACF,KAAA;IAEA,OAAO,IAAI,CAACC,cAAc,CAAA;AAC5B,GAAA;AACF;;;;"}